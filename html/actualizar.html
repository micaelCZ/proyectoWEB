<!DOCTYPE html>
<html>

<head>
  <title>Productos uwu</title>
  <meta charset="utf-8">
  <link rel="stylesheet" href="../css/estilo1.css">
  <link rel="icon" type="image/png" href="../img/logo.png" />
</head>
<body>
  <div class="navbar">
    <a href="inicio.html">Inicio</a>
    <div class="dropdown">
      <button class="dropbtn">Inventario
        <i class="fa fa-caret-down"></i>
      </button>
      <div class="dropdown-content">
        <a href="mPrima.html">Agregar materia prima</a>
        <a href="productos.html">Productos</a>
      </div>
    </div>
    <a href="reportes.html">Reportes</a>
    <a href="contabilidad.html">Contabilidad</a>
    <div id="fecha-hora">Usuario: admin - Fecha y hora: <time datetime=""></time></div>
  </div>
  <div>
    <h1>Resultado del formulario</h1>
    <form action="../php/productos.php" method="post">
      <input type="submit" value="Cargar Datos" onclick="window.location.reload()">
      <br>
      <label for="busqueda">Buscar:</label>
      <input type="text" id="busqueda" name="busqueda">
      <br>
      <table id="productos-table">
        <thead>
          <tr>
            <th>Nombre del producto</th>
            <th>Cantidad</th>
            <th>Unidad</th>
            <th>Fecha de vencimiento</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </form>

  </div>
  <div id="pie">
    <p>Pastelería Le Postré © 2023 - Todos los derechos reservados</p>
  </div>
  <script src="../js/fechaHora.js"></script>
  <script>
    //obtener datos del archivo json
fetch('../json/productos.json')
  .then(response => response.json())
  .then(data => {
    //inserta salto de línea en el json
    const jsonStr = JSON.stringify(data, null, 4);

    // crear tabla y agregar datos
    const tableBody = document.querySelector('#productos-table tbody');
    const busquedaInput = document.querySelector('#busqueda');
    const filas = [];
    data.forEach(producto => {
      const row = document.createElement('tr');
      const nombreCell = document.createElement('td');
      nombreCell.textContent = producto.nombre;
      row.appendChild(nombreCell);
      const cantidadCell = document.createElement('td');
      cantidadCell.textContent = producto.cantidad;
      row.appendChild(cantidadCell);
      const unidadCell = document.createElement('td');
      unidadCell.textContent = producto.unidad;
      row.appendChild(unidadCell);
      const fechaCell = document.createElement('td');
      fechaCell.textContent = producto.fecha_vencimiento;
      row.appendChild(fechaCell);
      filas.push(row);
      tableBody.appendChild(row);
    });

    // función para filtrar las filas de la tabla según el valor de búsqueda
    function filtrar() {
      const valorBusqueda = busquedaInput.value.toLowerCase().trim();
      filas.forEach(fila => {
        const ocultar = !fila.textContent.toLowerCase().includes(valorBusqueda);
        fila.style.display = ocultar ? 'none' : '';
      });
    }

    // agregar evento de entrada a la barra de búsqueda para filtrar la tabla
    busquedaInput.addEventListener('input', filtrar);
  });

  </script>
</body>
</html>